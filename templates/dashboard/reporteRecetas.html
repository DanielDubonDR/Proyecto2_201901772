<!doctype html>
<html class="no-js" lang="es">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Dashboard</title>
    <link rel="shortcut icon" type="image/png" href="https://img.icons8.com/officel/16/000000/cook-male.png">
    <link rel="stylesheet" href="{{url_for('static', filename = 'assets/css/bootstrap.min.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename = 'assets/css/font-awesome.min.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename = 'assets/css/themify-icons.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename = 'assets/css/metisMenu.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename = 'assets/css/owl.carousel.min.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename = 'assets/css/slicknav.min.css')}}">
    <!-- amchart css -->
    <link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />
    <!-- others css -->
    <link rel="stylesheet" href="{{url_for('static', filename = 'assets/css/typography.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename = 'assets/css/default-css.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename = 'assets/css/styles.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename = 'assets/css/responsive.css')}}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lobster">
    <!-- modernizr css -->
    <script src="{{url_for('static', filename = 'assets/js/vendor/modernizr-2.8.3.min.js')}}"></script>

</head>

<body>
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <!-- preloader area start -->
    <div id="preloader">
        <div class="loader"></div>
    </div>
    <!-- preloader area end -->
    <!-- page container area start -->
    <div class="page-container">
        <!-- sidebar menu area start -->
        <div class="sidebar-menu">
            <div class="sidebar-header">
                <div class="logo">
                    <a href="/dashboard"><img src="https://img.icons8.com/officel/100/000000/cook-male.png" alt="logo"></a>
                </div>
            </div>
            <div class="main-menu">
                <div class="menu-inner">
                    <nav>
                        <ul class="metismenu" id="menu">
                            <li><a href="/dashboard"><i class="ti-dashboard "></i> <span>Dashboard</span></a></li>
                            <li class="active">
                                <a href="javascript:void(0)" aria-expanded="true"><i class="ti-layout-cta-center "></i><span>Recetas</span></a>
                                <ul class="collapse">
                                    <li ><a href="/dashboard/recetasPublicadas">Recetas Publicadas</a></li>
                                    <li class="active"><a href="/dashboard/recetaReporte">Generar reporte de recetas</a></li>
                                </ul>
                            </li>
                            <li><a href="/dashboard/comentarios"><i class=" ti-comment-alt "></i> <span>Comentarios</span></a></li>
                            <li>
                                <a href="javascript:void(0)" aria-expanded="true"><i class="ti-thumb-up "></i><span>Reacciones</span></a>
                                <ul class="collapse">
                                    
                                    <li><a href="/dashboard/agregarReacciones">Agregar reacciones</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="javascript:void(0)" aria-expanded="true"><i class=" ti-user "></i><span>Usuarios</span></a>
                                <ul class="collapse">
                                    <li><a href="/dashboard/usuarios">Usuarios Registrados</a></li>
                                    <li><a href="/dashboard/usuarios/registrar">Registrar Usuario</a></li>
                                </ul>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
        <!-- sidebar menu area end -->
        <!-- main content area start -->
        <div class="main-content">
            <!-- header area start -->
            <div class="header-area">
                <div class="row align-items-center">
                    <!-- nav and search button -->
                    <div class="col-md-6 col-sm-8 clearfix">
                        <div class="nav-btn pull-left">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <h6 class="page-title pull-right" style="font-family: Lobster, serif;" >CUK</h6>
                    </div>
                    <!-- profile info & task notification -->
                    <div class="col-md-6 col-sm-4 clearfix">
                        <ul class="notification-area pull-right">
                            <li id="full-view"><i class="ti-fullscreen"></i></li>
                            <li id="full-view-exit"><i class="ti-zoom-out"></i></li>
                            <li class="dropdown">
                                <i class="ti-bell dropdown-toggle" data-toggle="dropdown">
                                    <span>1</span>
                                </i>
                                <div class="dropdown-menu bell-notify-box notify-box">
                                    <span class="notify-title">You have 1 new notifications <a href="#">view all</a></span>
                                    <div class="nofity-list">
                                        <a href="#" class="notify-item">
                                            <div class="notify-thumb"><i class="ti-key btn-danger"></i></div>
                                            <div class="notify-text">
                                                <p>You have Changed Your Password</p>
                                                <span>Just Now</span>
                                            </div>
                                        </a>
                                        <a href="#" class="notify-item">
                                            <div class="notify-thumb"><i class="ti-comments-smiley btn-info"></i></div>
                                            <div class="notify-text">
                                                <p>New Commetns On Post</p>
                                                <span>30 Seconds ago</span>
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- header area end -->
            <!-- page title area start -->
            <div class="page-title-area">
                <div class="row align-items-center">
                    <div class="col-sm-6">
                        <div class="breadcrumbs-area clearfix">
                            <h4 class="page-title pull-left">Recetas</h4>
                            <ul class="breadcrumbs pull-left">
                                <li><a href="index.html">Home</a></li>
                                <li><span>Reporte</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-sm-6 clearfix">
                        <div class="user-profile pull-right">
                            <h4 class="user-name dropdown-toggle" data-toggle="dropdown">{{nombre}}<i class="fa fa-angle-down"></i></h4>
                            <div class="dropdown-menu">
                                <a class="dropdown-item" href="/">Vista de Usuario</a>
                                <a class="dropdown-item" href="/perfil">Modificar Perfil</a>
                                <a class="dropdown-item" href="/logout">Cerrar Sesión</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- page title area end -->
            <div class="main-content-inner">
                 <!-- seo fact area start -->
            <div id="cuerpo">
                 <div class="col-lg-8">
                    <div class="row">
                        <div class="col-md-6 mt-5 mb-3">
                            <div class="card">
                                <div class="seo-fact sbg1">
                                    <div class="p-4 d-flex justify-content-between align-items-center">
                                        <div class="seofct-icon">Recetas</div>
                                        <h2>{{nrecetas}}</h2>
                                    </div>
                                    <canvas id="seolinechart1" height="10"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- seo fact area end -->
               <!-- Progress Table start -->
                    <div class="col-12 mt-5">
                        <div class="card">
                            <div class="card-body">
                                
                                
                                <h4 class="header-title">Recetas Publicadas</h4>
                                <div class="single-table">
                                    <div class="table-responsive">
                                        <table class="table table-hover progress-table text-center">
                                            <thead class="text-uppercase">
                                                <tr>
                                                    <th scope="col">ID</th>
                                                    <th scope="col">Receta</th>
                                                    <!-- <th scope="col">Fecha de Publicación</th> -->
                                                    <th scope="col">Resumen</th>
                                                    <th scope="col">Tiempo de preparación</th>
                                                    <th scope="col">Autor</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for Receta in recipes %}
                                                <tr>
                                                    <td>{{Receta.id}}</td>
                                                    <td>{{Receta.titulo}}</td>
                                                    <!--<td>09 / 07 / 2018</td>-->
                                                    <td style="text-align: justify;">{{Receta.resumen}}</td>
                                                    <td>{{Receta.tiempo}}</td>
                                                    <td>{{Receta.autor}}</td>
                                                </tr>
                                                {% endfor%}
                                            </tbody>
                                        </table>
                                        
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Progress Table end --> 
            </div>       
                

                    <div class="col-12 mt-5">
                        <div class="card">
                            <div class="card-body">
                                <button type="button" id="rpt" class="btn btn-info btn-lg btn-block">Generar Reporte</button>
                            </div>
                        </div>
                    </div>   
               
        	</div>
            <!-- main content area end -->
                  
    <script>
        function Eliminar(id){       
        fetch(`/dashboard/recetas/eliminar/${id}`, {
        method: 'DELETE',
        }).then(res => res.json())
        .catch(error => {
            console.error('Error:', error)
            alert("Ocurrio un error")
        })
        .then(response =>{
            console.log('Success:', response);
            alert(response.message)
            location.reload
            //location.href="/dashboard/recetasPublicadas"
        }) 
    }

      function cargarArchivo(){
        $('#file').parse({
      		config: {
			     delimiter: ",",
			     complete: agregarRecetas,
		      },
      		before: function(file, inputElem)
      		{
      			console.log("Parsing file...", file);
      		},
      		error: function(err, file)
      		{
      			console.log("ERROR:", err, file);
      		},
      		complete: function()
      		{
            console.log("Done with all files");
          }
        });
      }

      async function agregarRecetas(results) {
        console.log(results.data)
        var data = results.data;
        var val = true
        for (i = 0; i < data.length; i++) {
            var autor = data[i][0]
            var titulo = data[i][1]
            var resumen = data[i][2]
            var ingredientes = data[i][3]
            var procedimiento = data[i][4]
            var tiempo = data[i][5]
            var url = data[i][6]
            var objeto = {
                'autor': autor,
                'titulo': titulo,
                'resumen': resumen,
                'ingredientes': ingredientes,
                'procedimiento': procedimiento,
                'tiempo': tiempo,
                'url': url       
             }
            console.log(objeto)
            fetch('/dashboard/cargaMasiva', {
            method: 'POST',
            body: JSON.stringify(objeto),
            headers:{
                'Content-Type': 'application/json'
            }
            }).then(res => res.json())
            .catch(error => {
                console.error('Error:', error)
                alert("Ocurrio un error al consumir la API, revise la consola")
                val = false
            })
            .then(response =>{
                console.log('Success:', response);
                location.reload()
            }) 
            }
            if(val = true)
            {
                alert("Se agregaron las recetas correctamente")
            }
    }
    </script>

   
    <!--PDF-->
    <script src="{{url_for('static', filename = 'js/html2pdf.bundle.min.js')}}"></script>
    <script src="{{url_for('static', filename = 'js/script.js')}}"></script>
    <script src="{{url_for('static', filename = 'assets/js/vendor/jquery-2.2.4.min.js')}}"></script> 
    <!-- bootstrap 4 js -->
    <script src="{{url_for('static', filename = 'assets/js/popper.min.js')}}"></script>
    <script src="{{url_for('static', filename = 'assets/js/bootstrap.min.js')}}"></script>
    <script src="{{url_for('static', filename = 'assets/js/owl.carousel.min.js')}}"></script>
    <script src="{{url_for('static', filename = 'assets/js/metisMenu.min.js')}}"></script>
    <script src="{{url_for('static', filename = 'assets/js/jquery.slimscroll.min.js')}}"></script>
    <script src="{{url_for('static', filename = 'assets/js/jquery.slicknav.min.js')}}"></script>
    <!-- others plugins -->
    <script src="{{url_for('static', filename = 'assets/js/plugins.js')}}"></script>
    <script src="{{url_for('static', filename = 'assets/js/scripts.js')}}"></script>
</body>

</html>